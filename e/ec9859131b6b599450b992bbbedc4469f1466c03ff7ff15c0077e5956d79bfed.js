(function(){})(this,function(__WEBPACK_EXTERNAL_MODULE_1__){return(function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:false};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports;}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p="";return __webpack_require__(0);})([function(module,exports,__webpack_require__){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{'default':obj};}var _jquery=__webpack_require__(1);var _jquery2=_interopRequireDefault(_jquery);var _cropit=__webpack_require__(2);var _cropit2=_interopRequireDefault(_cropit);var _constants=__webpack_require__(4);var _utils=__webpack_require__(6);var applyOnEach=function(){};var callOnFirst=function(){};var methods={init:function(){},destroy:function(){},isZoomable:function isZoomable(){return callOnFirst(this,'isZoomable');},'export':function(){},imageState:function imageState(){return callOnFirst(this,'getImageState');},imageSize:function imageSize(){return callOnFirst(this,'getImageSize');},prop:function prop(name,value){if((0,_utils.exists)(value)){return applyOnEach(this,function(){});}else{return callOnFirst(this,'get'+(0,_utils.capitalize)(name));}},disable:function disable(){return applyOnEach(this,function(cropit){cropit.disable();});},reenable:function reenable(){return applyOnEach(this,function(cropit){cropit.reenable();});}};_jquery2['default'].fn.cropit=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(['imageSrc','offset','previewSize','zoom','initialZoom','exportZoom','minZoom','maxZoom'].indexOf(method)>=0){return methods.prop.apply(this,arguments);}else{return methods.init.apply(this,arguments);}};},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_1__;},function(module,exports,__webpack_require__){Object.defineProperty(exports,'__esModule',{value:true});var _createClass=(function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};})();function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{'default':obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function');}}var _jquery=__webpack_require__(1);var _jquery2=_interopRequireDefault(_jquery);var _Zoomer=__webpack_require__(3);var _Zoomer2=_interopRequireDefault(_Zoomer);var _constants=__webpack_require__(4);var _options=__webpack_require__(5);var _utils=__webpack_require__(6);var Cropit=(function(){function(){}_createClass(Cropit,[{key:'init',value:function init(){var _this=this;this.image=new Image();this.preImage=new Image();this.image.onload=this.onImageLoaded.bind(this);this.preImage.onload=this.onPreImageLoaded.bind(this);this.image.onerror=this.preImage.onerror=function(){};this.$fileInput=this.options.$fileInput.attr({accept:'image/*'});this.$preview=this.options.$preview.css({backgroundRepeat:'no-repeat'});this.$zoomSlider=this.options.$zoomSlider.attr({min:0,max:1,step:0.01});this.previewSize={w:this.options.width||this.$preview.width(),h:this.options.height||this.$preview.height()};if(this.options.width){this.$preview.width(this.previewSize.w);}if(this.options.height){this.$preview.height(this.previewSize.h);}if(this.options.imageBackground){if(_jquery2['default'].isArray(this.options.imageBackgroundBorderWidth)){this.imageBgBorderWidthArray=this.options.imageBackgroundBorderWidth;}else{this.imageBgBorderWidthArray=[];[0,1,2,3].forEach(function(i){_this.imageBgBorderWidthArray[i]=_this.options.imageBackgroundBorderWidth;});}var $previewContainer=this.options.$previewContainer;this.$imageBg=(0,_jquery2['default'])('<img />').addClass(_constants.CLASS_NAMES.IMAGE_BACKGROUND).attr('alt','').css('position','absolute');this.$imageBgContainer=(0,_jquery2['default'])('<div />').addClass(_constants.CLASS_NAMES.IMAGE_BACKGROUND_CONTAINER).css({position:'absolute',zIndex:0,left:-this.imageBgBorderWidthArray[3]+window.parseInt(this.$preview.css('border-left-width')||0),top:-this.imageBgBorderWidthArray[0]+window.parseInt(this.$preview.css('border-top-width')||0),width:this.previewSize.w+this.imageBgBorderWidthArray[1]+this.imageBgBorderWidthArray[3],height:this.previewSize.h+this.imageBgBorderWidthArray[0]+this.imageBgBorderWidthArray[2]}).append(this.$imageBg);if(this.imageBgBorderWidthArray[0]>0){this.$imageBgContainer.css('overflow','hidden');}$previewContainer.css('position','relative').prepend(this.$imageBgContainer);this.$preview.css('position','relative');this.$preview.hover(function(){_this.$imageBg.addClass(_constants.CLASS_NAMES.PREVIEW_HOVERED);},function(){_this.$imageBg.removeClass(_constants.CLASS_NAMES.PREVIEW_HOVERED);});}this.setInitialZoom(this.options.initialZoom);this.imageLoaded=false;this.moveContinue=false;this.zoomer=new _Zoomer2['default']();if(this.options.allowDragNDrop){_jquery2['default'].event.props.push('dataTransfer');}this.bindListeners();if(this.options.imageState&&this.options.imageState.src){this.loadImage(this.options.imageState.src);}}},{key:'bindListeners',value:function(){}},{key:'unbindListeners',value:function(){}},{key:'onFileChange',value:function(){}},{key:'loadFileReader',value:function(){}},{key:'onFileReaderLoaded',value:function(){}},{key:'onFileReaderError',value:function onFileReaderError(){this.options.onFileReaderError();}},{key:'onDragOver',value:function(){}},{key:'onDrop',value:function(){}},{key:'loadImage',value:function loadImage(imageSrc){if(!imageSrc){return;}this.options.onImageLoading();this.setImageLoadingClass();this.preImage.src=imageSrc;}},{key:'setImageSrc',value:function setImageSrc(imageSrc){this.loadImage(imageSrc);}},{key:'onPreImageLoaded',value:function onPreImageLoaded(){if(this.options.smallImage==='reject'&&(this.preImage.width*this.options.maxZoom<this.previewSize.w*this.options.exportZoom||this.preImage.height*this.options.maxZoom<this.previewSize.h*this.options.exportZoom)){this.onImageError(_constants.ERRORS.SMALL_IMAGE);if(this.image.src){this.setImageLoadedClass();}return;}if(this.options.allowCrossOrigin){this.image.crossOrigin=this.preImage.src.indexOf('data:')===0?null:'Anonymous';}this.image.src=this.imageSrc=this.preImage.src;}},{key:'onImageLoaded',value:function onImageLoaded(){this.imageSize={w:this.image.width,h:this.image.height};this.setupZoomer(this.options.imageState&&this.options.imageState.zoom||this.initialZoom);if(this.options.imageState&&this.options.imageState.offset){this.setOffset(this.options.imageState.offset);}else{this.centerImage();}this.options.imageState={};this.$preview.css('background-image','url('+this.imageSrc+')');if(this.options.imageBackground){this.$imageBg.attr('src',this.imageSrc);}this.setImageLoadedClass();this.imageLoaded=true;this.options.onImageLoaded();}},{key:'onImageError',value:function(){}},{key:'setImageLoadingClass',value:function(){}},{key:'setImageLoadedClass',value:function setImageLoadedClass(){this.$preview.removeClass(_constants.CLASS_NAMES.IMAGE_LOADING).addClass(_constants.CLASS_NAMES.IMAGE_LOADED);}},{key:'removeImageLoadingClass',value:function(){}},{key:'getEventPosition',value:function(){}},{key:'onPreviewEvent',value:function(){}},{key:'onMove',value:function onMove(e){var eventPosition=this.getEventPosition(e);if(this.moveContinue&&eventPosition){this.setOffset({x:this.offset.x+eventPosition.x-this.origin.x,y:this.offset.y+eventPosition.y-this.origin.y});}this.origin=eventPosition;e.stopPropagation();return false;}},{key:'setOffset',value:function setOffset(position){if(!position||!(0,_utils.exists)(position.x)||!(0,_utils.exists)(position.y)){return;}this.offset=this.fixOffset(position);this.$preview.css('background-position',''+this.offset.x+'px '+this.offset.y+'px');if(this.options.imageBackground){this.$imageBg.css({left:this.offset.x+this.imageBgBorderWidthArray[3],top:this.offset.y+this.imageBgBorderWidthArray[0]});}this.options.onOffsetChange(position);}},{key:'fixOffset',value:function fixOffset(offset){if(!this.imageLoaded){return offset;}var ret={x:offset.x,y:offset.y};if(!this.options.freeMove){if(this.imageSize.w*this.zoom>=this.previewSize.w){ret.x=Math.min(0,Math.max(ret.x,this.previewSize.w-this.imageSize.w*this.zoom));}else{ret.x=Math.max(0,Math.min(ret.x,this.previewSize.w-this.imageSize.w*this.zoom));}if(this.imageSize.h*this.zoom>=this.previewSize.h){ret.y=Math.min(0,Math.max(ret.y,this.previewSize.h-this.imageSize.h*this.zoom));}else{ret.y=Math.max(0,Math.min(ret.y,this.previewSize.h-this.imageSize.h*this.zoom));}}ret.x=(0,_utils.round)(ret.x);ret.y=(0,_utils.round)(ret.y);return ret;}},{key:'centerImage',value:function centerImage(){if(!this.imageSize||!this.zoom){return;}this.setOffset({x:(this.previewSize.w-this.imageSize.w*this.zoom)/2,y:(this.previewSize.h-this.imageSize.h*this.zoom)/2});}},{key:'onZoomSliderChange',value:function onZoomSliderChange(){if(!this.imageLoaded){return;}this.zoomSliderPos=Number(this.$zoomSlider.val());var newZoom=this.zoomer.getZoom(this.zoomSliderPos);if(newZoom===this.zoom){return;}this.setZoom(newZoom);}},{key:'enableZoomSlider',value:function(){}},{key:'disableZoomSlider',value:function(){}},{key:'setupZoomer',value:function setupZoomer(zoom){this.zoomer.setup({imageSize:this.imageSize,previewSize:this.previewSize,exportZoom:this.options.exportZoom,maxZoom:this.options.maxZoom,minZoom:this.options.minZoom,smallImage:this.options.smallImage});this.setZoom((0,_utils.exists)(zoom)?zoom:this.zoom);if(this.isZoomable()){this.enableZoomSlider();}else{this.disableZoomSlider();}}},{key:'setZoom',value:function setZoom(newZoom){newZoom=this.fixZoom(newZoom);var updatedWidth=(0,_utils.round)(this.imageSize.w*newZoom);var updatedHeight=(0,_utils.round)(this.imageSize.h*newZoom);if(this.imageLoaded){var oldZoom=this.zoom;var newX=this.previewSize.w/2-(this.previewSize.w/2-this.offset.x)*newZoom/oldZoom;var newY=this.previewSize.h/2-(this.previewSize.h/2-this.offset.y)*newZoom/oldZoom;this.zoom=newZoom;this.setOffset({x:newX,y:newY});}else{this.zoom=newZoom;}this.zoomSliderPos=this.zoomer.getSliderPos(this.zoom);this.$zoomSlider.val(this.zoomSliderPos);this.$preview.css('background-size',''+updatedWidth+'px '+updatedHeight+'px');if(this.options.imageBackground){this.$imageBg.css({width:updatedWidth,height:updatedHeight});}this.options.onZoomChange(newZoom);}},{key:'fixZoom',value:function fixZoom(zoom){return this.zoomer.fixZoom(zoom);}},{key:'isZoomable',value:function isZoomable(){return this.zoomer.isZoomable();}},{key:'getCroppedImageData',value:function getCroppedImageData(exportOptions){if(!this.imageSrc){return;}var exportDefaults={type:'image/png',quality:0.75,originalSize:false,fillBg:'#fff'};exportOptions=_jquery2['default'].extend({},exportDefaults,exportOptions);var exportZoom=exportOptions.originalSize?1/this.zoom:this.options.exportZoom;var zoomedSize={w:this.zoom*exportZoom*this.imageSize.w,h:this.zoom*exportZoom*this.imageSize.h};var canvas=(0,_jquery2['default'])('<canvas />').attr({width:this.previewSize.w*exportZoom,height:this.previewSize.h*exportZoom}).get(0);var canvasContext=canvas.getContext('2d');if(exportOptions.type==='image/jpeg'){canvasContext.fillStyle=exportOptions.fillBg;canvasContext.fillRect(0,0,canvas.width,canvas.height);}canvasContext.drawImage(this.image,this.offset.x*exportZoom,this.offset.y*exportZoom,zoomedSize.w,zoomedSize.h);return canvas.toDataURL(exportOptions.type,exportOptions.quality);}},{key:'getImageState',value:function(){}},{key:'getImageSrc',value:function getImageSrc(){return this.imageSrc;}},{key:'getOffset',value:function getOffset(){return this.offset;}},{key:'getZoom',value:function getZoom(){return this.zoom;}},{key:'getImageSize',value:function getImageSize(){if(!this.imageSize){return null;}return{width:this.imageSize.w,height:this.imageSize.h};}},{key:'getInitialZoom',value:function getInitialZoom(){return this.options.initialZoom;}},{key:'setInitialZoom',value:function setInitialZoom(initialZoomOption){this.options.initialZoom=initialZoomOption;if(initialZoomOption==='min'){this.initialZoom=0;}else if(initialZoomOption==='image'){this.initialZoom=1;}else{this.initialZoom=0;}}},{key:'getExportZoom',value:function getExportZoom(){return this.options.exportZoom;}},{key:'setExportZoom',value:function setExportZoom(exportZoom){this.options.exportZoom=exportZoom;this.setupZoomer();}},{key:'getMinZoom',value:function getMinZoom(){return this.options.minZoom;}},{key:'setMinZoom',value:function setMinZoom(minZoom){this.options.minZoom=minZoom;this.setupZoomer();}},{key:'getMaxZoom',value:function getMaxZoom(){return this.options.maxZoom;}},{key:'setMaxZoom',value:function(){}},{key:'getPreviewSize',value:function(){}},{key:'setPreviewSize',value:function setPreviewSize(size){if(!size||size.width<=0||size.height<=0){return;}this.previewSize={w:size.width,h:size.height};this.$preview.css({width:this.previewSize.w,height:this.previewSize.h});if(this.options.imageBackground){this.$imageBgContainer.css({width:this.previewSize.w+this.imageBgBorderWidthArray[1]+this.imageBgBorderWidthArray[3],height:this.previewSize.h+this.imageBgBorderWidthArray[0]+this.imageBgBorderWidthArray[2]});}if(this.imageLoaded){this.setupZoomer();}}},{key:'disable',value:function disable(){this.unbindListeners();this.disableZoomSlider();this.$el.addClass(_constants.CLASS_NAMES.DISABLED);}},{key:'reenable',value:function(){}},{key:'$',value:function $(selector){if(!this.$el){return null;}return this.$el.find(selector);}}]);return Cropit;})();exports['default']=Cropit;module.exports=exports['default'];},function(){},function(){},function(module,exports,__webpack_require__){Object.defineProperty(exports,'__esModule',{value:true});var _constants=__webpack_require__(4);var options={elements:[{name:'$preview',description:'The HTML element that displays image preview.',defaultSelector:'.'+_constants.CLASS_NAMES.PREVIEW},{name:'$fileInput',description:'File input element.',defaultSelector:'input.'+_constants.CLASS_NAMES.FILE_INPUT},{name:'$zoomSlider',description:'Range input element that controls image zoom.',defaultSelector:'input.'+_constants.CLASS_NAMES.ZOOM_SLIDER},{name:'$previewContainer',description:'Preview container. Only needed when `imageBackground` is true.',defaultSelector:'.'+_constants.CLASS_NAMES.PREVIEW_CONTAINER}].map(function(){}),values:[{name:'width',type:'number',description:'Width of image preview in pixels. If set, it will override the CSS property.','default':null},{name:'height',type:'number',description:'Height of image preview in pixels. If set, it will override the CSS property.','default':null},{name:'imageBackground',type:'boolean',description:'Whether or not to display the background image beyond the preview area.','default':false},{name:'imageBackgroundBorderWidth',type:'array or number',description:'Width of background image border in pixels.\n        The four array elements specify the width of background image width on the top, right, bottom, left side respectively.\n        The background image beyond the width will be hidden.\n        If specified as a number, border with uniform width on all sides will be applied.','default':[0,0,0,0]},{name:'exportZoom',type:'number',description:'The ratio between the desired image size to export and the preview size.\n        For example, if the preview size is `300px * 200px`, and `exportZoom = 2`, then\n        the exported image size will be `600px * 400px`.\n        This also affects the maximum zoom level, since the exported image cannot be zoomed to larger than its original size.','default':1},{name:'allowDragNDrop',type:'boolean',description:'When set to true, you can load an image by dragging it from local file browser onto the preview area.','default':true},{name:'minZoom',type:'string',description:'This options decides the minimal zoom level of the image.\n        If set to `\'fill\'`, the image has to fill the preview area, i.e. both width and height must not go smaller than the preview area.\n        If set to `\'fit\'`, the image can shrink further to fit the preview area, i.e. at least one of its edges must not go smaller than the preview area.','default':'fill'},{name:'maxZoom',type:'number',description:'Determines how big the image can be zoomed. E.g. if set to 1.5, the image can be zoomed to 150% of its original size.','default':1},{name:'initialZoom',type:'string',description:'Determines the zoom when an image is loaded.\n        When set to `\'min\'`, image is zoomed to the smallest when loaded.\n        When set to `\'image\'`, image is zoomed to 100% when loaded.','default':'min'},{name:'freeMove',type:'boolean',description:'When set to true, you can freely move the image instead of being bound to the container borders','default':false},{name:'smallImage',type:'string',description:'When set to `\'reject\'`, `onImageError` would be called when cropit loads an image that is smaller than the container.\n        When set to `\'allow\'`, images smaller than the container can be zoomed down to its original size, overiding `minZoom` option.\n        When set to `\'stretch\'`, the minimum zoom of small images would follow `minZoom` option.','default':'reject'},{name:'allowCrossOrigin',type:'boolean',description:'Set to true if you need to crop image served from other domains.','default':false}],callbacks:[{name:'onFileChange',description:'Called when user selects a file in the select file input.',params:[{name:'event',type:'object',description:'File change event object'}]},{name:'onFileReaderError',description:'Called when `FileReader` encounters an error while loading the image file.'},{name:'onImageLoading',description:'Called when image starts to be loaded.'},{name:'onImageLoaded',description:'Called when image is loaded.'},{name:'onImageError',description:'Called when image cannot be loaded.',params:[{name:'error',type:'object',description:'Error object.'},{name:'error.code',type:'number',description:'Error code. `0` means generic image loading failure. `1` means image is too small.'},{name:'error.message',type:'string',description:'A message explaining the error.'}]},{name:'onZoomEnabled',description:'Called when image the zoom slider is enabled.'},{name:'onZoomDisabled',description:'Called when image the zoom slider is disabled.'},{name:'onZoomChange',description:'Called when zoom changes.',params:[{name:'zoom',type:'number',description:'New zoom.'}]},{name:'onOffsetChange',description:'Called when image offset changes.',params:[{name:'offset',type:'object',description:'New offset, with `x` and `y` values.'}]}].map(function(){})};var loadDefaults=function(){};exports.loadDefaults=loadDefaults;exports['default']=options;},function(module,exports){Object.defineProperty(exports,'__esModule',{value:true});var exists=function(){};exports.exists=exists;var round=function(){};exports.round=round;var capitalize=function(){}