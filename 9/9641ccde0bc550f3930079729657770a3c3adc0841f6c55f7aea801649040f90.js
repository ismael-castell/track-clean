window.RTS=function(){function t(t){t=t||{},this.clientVersion=1,this.connection_startTime,this.socket_connection_time,this.timeoutPeriod=3e4,this.pingTimerInterval=15e3,this.tokenExpiryBufferPeriod=36e5,this.tokenFetchTimeout=2e4,this.channels={},this.timeouts={},this.callbacks={},this.timerID=0,this.attempts=0,this.clientClose,this.traceIdIncreamenter=0,this.reconnectionFlag=!1,this.stableConnectionTimer,this.stableConnectionTimeout=2e4,this.resubscriptionTimeout=3e3,this.resubscriptionMaxAttempts=3,this.reconnectionAttempts=t.reconnectionAttempts||3,this.sioReconnectionAttempts=t.sioReconnectionAttempts||1/0,this.reconnectionDelay=this._isNumberAndGreaterThanZero(t.reconnectionDelay)?t.reconnectionDelay:1e3,this.reconnectionDelayMax=t.reconnectionDelayMax||6e4,this.debug=t.debug||!1,this.logger=t.logger||window.console,this.origin=t.origin,this.onConnect=t.onConnect||function(){},this.onConnectError=t.onConnectError||function(){},this.onReconnect=t.onReconnect||function(){},this.onReconnecting=t.onReconnecting||function(){},this.onDisconnect=t.onDisconnect||function(){},this.onFallback=t.onFallback||function(){},this.onMessage=t.onMessage||function(){},this.onAppMessage=t.onAppMessage,this.isHealthCheckEnabled=t.isHealthCheckEnabled||!1,this.disconnectCount=0,this.connected=!1,this.serviceId=t.serviceId||"rts",this.traceId=t.ti||this._generateUid(),t.accId?this.accId=t.accId:this._throw("accId not provided"),t.userId?this.userId=t.userId:this._throw("userId not provided"),this.token=t.token?encodeURIComponent(t.token):"",t.webURL&&(this.webURL=t.webURL),t.leaveOnUnload&&this.leaveOnUnload(),"function"==typeof t.fetchToken&&(this.fetchToken=t.fetchToken),this.socket=null,this.nocookie=null,this.initializeSocket(),this.initializeTokenRefresh()}return t.prototype={constructor:t,generateWsUrl:function(t,e){var n="wss";return 0==t.indexOf("http://localhost")&&(n="ws"),t.replace(/[^:]*/,n)+"/ws?"+e},generateSioUrl:function(){},errorHandler:function(t){var e=this;if(e.log("attempts: ",e.attempts),e.websocket.readyState<2)try{e.websocket.close()}catch(t){e.log(t)}e.attempts>=e.reconnectionAttempts-1?(e.log("failed to connect via websocket, falling back to sio"),e.timerID&&(window.clearTimeout(e.timerID),e.timerID=0,e.attempts=0),delete e.websocket,e.initializeSocketIO()):(this.reconnectionFlag=!0,e.timerID||(e.log("setting timerID"),e.timerID=setTimeout(function(){clearTimeout(e.timerID),e.timerID=0,e.connected||e.errorHandler()},e.reconnectionDelay*(e._isNumberAndGreaterThanZero(e.attempts)?e.attempts:1)*10),e._onReconnecting(),null!=navigator&&0==navigator.onLine||(e.log("incrementing retry attempts"),e.attempts++),e.initializeSocket()))},initializeSocket:function(){var n,o=this;this.checkCookieSupport(function(t){var e;o.nocookie=t,1!=o.clientClose&&(n=o._getQueryParams(t),t=o.generateWsUrl(o.origin,n),null!=window.WebSocket?(o.log("creating new socket,",Date()),e=new WebSocket(t),o.websocket=e,o.websocket.onopen=function(){o.websocket==e&&(o.stableConnectionTimer=setTimeout(function(){o.attempts=0},o.stableConnectionTimeout),o.reconnectionFlag&&o._onReconnect(),o.initializeWebSocket(e))},o.websocket.onerror=function(t){o.websocket==e&&(window.clearTimeout(o.stableConnectionTimer),o.errorHandler(t))}):o.initializeSocketIO())})},initializeWebSocket:function(n){this.log("Initializing websocket connnection..."),this.connection_startTime=(new Date).getTime();var o=this,e=null;this.websocket.onmessage=function(e){if(o.websocket==n){let t;t=o._safelyParseJSON(e.data),"PONG"!=t.event&&o.log("Received Data.",t),o._onEvent(t)}},this.websocket.onclose=function(t){o.websocket==n&&(window.clearTimeout(o.stableConnectionTimer),o.clientClose?(o.log("websocket closed"),o.websocket.close()):(o.connected&&o._onDisconnect("ping timeout",o),o.log("attempting to reconnect"),o.errorHandler(t)),clearInterval(e))},this.reconnectionFlag||(this._onConnect(),this.reconnectionFlag=!0),e=setInterval(function(){o.websocket==n?1==n.readyState&&n.send("9"):clearInterval(e)},o.pingTimerInterval)},initializeSocketIO:function(){1!=this.clientClose&&(this.log("Initializing socket connection..."),this.connection_startTime=(new Date).getTime(),this.checkCookieSupport(function(t){this.nocookie=t;t=this.io.Manager(this.generateSioUrl(),{forceBase64:!0,reconnectionAttempts:this.sioReconnectionAttempts,reconnectionDelay:this.reconnectionDelay,reconnectionDelayMax:this.reconnectionDelayMax});this.socket=t.socket("/"),this.initializeSocketListeners()}.bind(this)))},initializeSocketListeners:function(){this.log("Binding the socket listeners..."),this.socket.on("connect",function(){this.onFallback(),this._onConnect()}.bind(this)),this.socket.on("connect_error",this._onConnectError.bind(this)),this.socket.on("reconnecting",this._onReconnecting.bind(this)),this.socket.on("reconnect",this._onReconnect.bind(this)),this.socket.on("disconnect",this._onDisconnect.bind(this)),this.socket.on("message",this._onMessage.bind(this))},initializeTokenRefresh:function(){var e,t;null==this.token||""==this.token||"function"!=typeof this.fetchToken||(t=this.getTokenExpiry(decodeURIComponent(this.token)))!=1/0&&(e=this,(t=t-(new Date).getTime()-this.tokenExpiryBufferPeriod)<=0&&(t+=this.tokenExpiryBufferPeriod),setTimeout(function(){1!=e.clientClose&&e.fetchToken(function(t){null!=t&&""!=t&&(e.token=encodeURIComponent(t),e.socket&&e.socket.io&&e.socket.io.uri&&(e.socket.io.uri=e.generateSioUrl()),e.connected&&e.grant(t)),setTimeout(function(){e.initializeTokenRefresh()},e.tokenFetchTimeout)})},t))},getTokenExpiry:function(t){for(var e=JSON.parse(atob(t.split(".")[1])).credentials,n=1/0,o=0;o<e.length;o++){var r=e[o];isNaN(r.expire)||(n=Math.min(n,parseInt(r.expire)))}return n},refreshToken:function(){var e;"function"==typeof this.fetchToken&&(e=this).fetchToken(function(t){null!=t&&""!=t&&(e.token=encodeURIComponent(t),e.connected&&e.grant(t))})},removeSocketListeners:function(t){this.socket&&this.socket.off(t)},checkCookieSupport:function(e){null===this.nocookie?!0!==(/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||void 0!==window.safari&&window.safari.pushNotification).toString())?this.sendCookieRequest("get",function(t){t?this.sendCookieRequest("check",function(t){t?(this.log("Browser supports cookie from a different domain"),e(!1)):(this.log("Browser does not support cookie from a different domain"),e(!0))}.bind(this)):(this.log("Browser does not support cookie from a different domain"),e(!0))}.bind(this)):e(!0):e(this.nocookie)},sendCookieRequest:function(e,n){var t=new XMLHttpRequest,o=this,r=this.origin;this.origin&&"/"!==this.origin[this.origin.length-1]&&(r=this.origin+"/v2/cookie/"),t.open("GET",r+e),t.onreadystatechange=function(){if(4===this.readyState)if(o.log("Cookie request :: "+e+" response",this.responseText),200<=this.status&&this.status<300||304===this.status){var t=!0;if("check"==e){t=!1;try{t=JSON.parse(this.responseText).exist}catch(t){}}n(t)}else n(!1)},t.onerror=function(){o.log(t.statusText)},t.withCredentials=!0,t.send()},subscribe:function(n,o,r){void 0===(r=r||{}).resubscriptionAttempts&&(r.resubscriptionAttempts=0),"function"!=typeof o&&(o=null);var i=this,t="Already subscribed to channel: ";if(this.log("Trying to subscribe to channel: ",n),this._connectionCheck(o)){if(!r.forceResubscribe&&this._isChannelSubscribed(n))return this.log(t+n),r&&(i.channels[n].options=r),r.messageHandler&&(i.channels[n].onMessage=r.messageHandler),void(o&&o(null,t));delete r.forceResubscribe;var s=!1,c=setTimeout(function(){if(!s){if(s=!0,r.resubscriptionAttempts++,r.resubscriptionAttempts==i.resubscriptionMaxAttempts)return r.resubscriptionAttempts=0,window.clearTimeout(c),i.log("resubscription timed out, could not subscribe to channel",n),o&&o("subscription failed","tried subscribing"+i.resubscriptionMaxAttempts+" times: resubscription failed"),void(o=null);i.subscribe(n,o,r)}},i.resubscriptionTimeout);this._sendMessage({event:"subscribe",channel:n,serviceId:this.serviceId,token:r.token,ti:r.traceId,opt:r.opt||0},function(t,e){if(null==t){if(r.resubscriptionAttempts=0,s)return;s=!0,window.clearTimeout(c),i.channels[n]={connected:!0,options:r,onMessage:r.messageHandler},i._fireCallback(o,t,e)}t&&i.log("Could not subscribe to channel: ",t,n)})}},__getSocketOpt:function(t){return t=t||0,t|=64},subscribeSocket:function(t,e,n){n.opt=this.__getSocketOpt(n.opt),this.subscribe(t,e,n)},unsubscribe:function(n,o,t){t=t||{},"function"!=typeof o&&(o=null);var r=this;this._connectionCheck(o)&&this._isChannelSubscribed(n,o)&&this._sendMessage({event:"unsubscribe",channel:n,serviceId:this.serviceId,ti:t.traceId,opt:t.opt||0},function(t,e){t?r.log("Could not unsubscribe from channel: ",t,n):delete r.channels[n],o&&o(t,e)})},unsubscribeSocket:function(t,e,n){n.opt=this.__getSocketOpt(n.opt),this.unsubscribe(t,e,n)},unsubscribeAll:function(t,e){e=e||{},"function"!=typeof t&&(t=null),this._connectionCheck&&(this._sendMessage({event:"unsubscribeall",serviceId:this.serviceId,ti:e.traceId}),this.channels={},t&&t(null,this.channels))},ping:function(t){t=t||{},this.isHealthCheckEnabled&&this._connectionCheck&&this._sendMessage({event:"ping",userId:this.userId,serviceId:this.serviceId,ti:t.traceId})},channelWho:function(n,o,t){t=t||{},"function"!=typeof o&&(o=null);var r=this;this._connectionCheck(o)&&this._sendMessage({event:"channel_who",channel:n,serviceId:this.serviceId,ti:t.traceId,msg:JSON.stringify(t)},function(t,e){t&&r.log("Could not fetch channel_who: ",t,n),o&&o(t,e)})},userWhere:function(n,t){t=t||{},"function"!=typeof n&&(n=null);var o=this;this._connectionCheck(n)&&this._sendMessage({event:"user_where",serviceId:this.serviceId,ti:t.traceId},function(t,e){t&&o.log("Could not fetch user_where: ",t),n&&n(t,e)})},userThere:function(n,t){t=t||{},"function"!=typeof n&&(n=null);var o=this;this._connectionCheck(n)&&this._sendMessage({accId:this.accId,event:"user_there",userid:this.userId,serviceId:this.serviceId,ti:t.traceId},function(t,e){t&&o.log("Could not fetch user_there: ",t),n&&n(t,e)})},grant:function(t,n,e){e=e||{},"function"!=typeof n&&(n=null);var o=this;this._connectionCheck(n)&&this._sendMessage({event:"grant",msg:t,serviceId:this.serviceId,ti:e.traceId},function(t,e){t&&o.log("Could not grant access: ",t),n&&n(t,e)})},revoke:function(t,n,e){e=e||{},"function"!=typeof n&&(n=null);var o=this;this._connectionCheck(n)&&this._sendMessage({event:"revoke",msg:t,serviceId:this.serviceId,ti:e.traceId},function(t,e){t&&o.log("Could not revoke access: ",t),n&&n(t,e)})},save:function(t,n,o,e){e=e||{},"function"!=typeof o&&(o=null);var r=this;this._connectionCheck()&&this._isChannelSubscribed(t)&&this._sendMessage({event:"save",channel:t,serviceId:this.serviceId,ti:e.traceId,msg:JSON.stringify(n)},function(t,e){t?r.log("Could not fetch user_where: ",t):r.log("Saved data.",n),o&&o(t,e)})},fetch:function(t,n,e){e=e||{},"function"!=typeof n&&(n=null);var o=this;this._connectionCheck(n)&&this._isChannelSubscribed(t,n)&&this._sendMessage({event:"fetch",channel:t,userId:this.userId,serviceId:this.serviceId,ti:e.traceId},function(t,e){t&&o.log("Could not fetch user data: ",t),n&&n(t,e)})},publish:function(t,e,n,o){o=o||{},"function"!=typeof n&&(n=null),this._connectionCheck&&this._isChannelSubscribed(t,n)&&(t={event:"send",channel:t,msg:JSON.stringify(e),userid:o.userId,opt:o.opt||(o.persist?1:0),serviceId:this.serviceId,ti:o.traceId},o.msgType&&(t.msgType=o.msgType),this._sendMessage(t,n),this.log("Message sent",e))},persist:function(t,e,n,o){var r=this;o=o||{},"function"!=typeof n&&(n=null);function i(t,e){r.log("rest message send callback","Error: ",t," | Message: ",e),null!=n&&(n(t,e),n=null)}var t=this.origin+"/v1/message/send/"+this.accId+"/"+t+"?token="+this.token,o=o.persist?1:0,o='{"msg":'+JSON.stringify(e)+',"opt":"'+o+'","senderId":"'+this.userId+'"}',s=new XMLHttpRequest;s.onreadystatechange=function(){this.readyState==this.DONE&&(200<=this.status&&this.status<300?(r.log("message sent",e),i(null,s.responseText)):i("Server error, code: "+this.status,s.responseText))},s.ontimeout=function(){i("Timeout",null)},s.onerror=function(){i("Something went wrong",null)},s.timeout=2e4,s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/json"),s.send(o)},sendAck:function(t,e,n,o,r){r=r||{},"function"!=typeof o&&(o=null),this._connectionCheck(o)&&this._isChannelSubscribed(t,o)&&(this._sendMessage({accId:this.accId,event:"client_ack",channel:t,msg:e,userId:n,serviceId:this.serviceId,ti:r.traceId,msgPayload:JSON.stringify(r.message)}),o&&o(null,"Sent ack message"))},log:function(){var t,e;!0===this.debug&&this.logger&&(t=Array.prototype.slice.call(arguments),e="",t.unshift("RTS:"),t.unshift((new Date).toLocaleTimeString()),t.forEach(function(t){t instanceof Error?e+=t.toString()+" ":e+="object"==typeof t?JSON.stringify(t)+" ":t+" "}),this.logger.log(e))},close:function(t,e){if(this.clientClose=!0,e=e||{},this._connectionCheck(t)&&this._sendMessage({event:"close",serviceId:this.serviceId,ti:e.traceId}),"function"!=typeof t&&(t=null),this.websocket){try{this.websocket.close()}catch(t){this.log(t)}var n=this;setTimeout(function(){n._onDisconnect("forced close")},0)}else this.disconnect();t&&t(null,"Connection Closed")},disconnect:function(){},reconnect:function(t){this.socket.io.connect()},_fireCallback:function(t){var e;"function"==typeof t&&(e=Array.prototype.slice.call(arguments,1,arguments.length),setTimeout(function(){t.apply(null,e)},0))},_connectionCheck:function(t){var e="Not performing action as client is not connected.";return this.websocket?1==this.websocket.readyState||(this.log(e),t&&t(e),!1):(!1===this.connected&&(this.log(e),t&&t(e)),this.connected)},_sendMessage:function(t,e){let n;const o=t;e&&(n=this._generateUid(),this.callbacks[n]=e,o.clientId=n,this._startTimeoutErrorTimer(n)),o.accId=this.accId,this.websocket?(9!=o&&this.log("Sending data",o),this.websocket.send(JSON.stringify(o))):this.socket.emit("message",JSON.stringify(o))},_startTimeoutErrorTimer:function(t){var e=this;e.timeouts[t]=setTimeout(function(){e.callbacks[t]&&e.callbacks[t]("Timeout Error"),delete e.timeouts[t]},this.timeoutPeriod)},_generateUid:function(){},_isNumberAndGreaterThanZero:function(t){return"number"==typeof t&&0<t},_safelyParseJSON:function(e){var t;try{t=JSON.parse(e)}catch(t){return void this.log("MessageParseError",e)}return t},_isChannelSubscribed:function(t,e){var n="Channel "+t+" is not subscribed yet.";return this.channels[t]||(this.log(n),e&&e(n)),!!this.channels[t]},_onConnect:function(){var t;this.reconnectionFlag||(t=(new Date).getTime()-this.connection_startTime,this.log("Socket Connected"),this.websocket?(this.log("Time Taken by Websocket:- ",t),this.websocket.id=this._generateUid()):this.log("Time Taken by Socket.IO:- ",t),this.connected=!0,this._fireCallback(this.onConnect,this.reconnectionFlag),this.reconnectionFlag=!0)},_onConnectError:function(t){this.log("Socket Connect Error"),this._fireCallback(this.onConnectError,t)},_onReconnecting:function(){this.websocket?this.log("Websocket reconnecting"):this.log("Socket reconnecting"),this._fireCallback(this.onReconnecting)},_onReconnect:function(){var n=this;this.log("Socket reconnected"),window.clearTimeout(this.disconnect_timer),this.connected=!0,Object.keys(n.channels).forEach(function(t){var e=n.channels[t].options||{};e.forceResubscribe=!0,n.subscribe(t,null,e)}),this._fireCallback(n.onReconnect)},_onDisconnect:function(t,e){this.log("Disconnected"),this.connected=!1,this.clientClose&&(this.channels={}),this.disconnectCount+=1,this._fireCallback(this.onDisconnect,t,e)},_onEvent:function(t){if(t.clientId&&(this.timeouts[t.clientId]&&(clearTimeout(this.timeouts[t.clientId]),delete this.timeouts[t.clientId]),this.callbacks[t.clientId])){if(""!==t.err&&t.err){this.log("Error: ",t);try{this.callbacks[t.clientId](t.err)}catch(t){this.log(t)}}else try{this.callbacks[t.clientId](null,t)}catch(t){this.log(t)}delete this.callbacks[t.clientId]}"APP_PUBLISH"!=t.event||"function"!=typeof this.onAppMessage?("send"==t.event||"CHANNEL_JOIN"==t.event||"LEFT_CHANNEL"===t.event)&&t.channel&&this.channels[t.channel]&&"function"==typeof this.channels[t.channel].onMessage?this._fireCallback(this.channels[t.channel].onMessage,t):this._fireCallback(this.onMessage,t):this._fireCallback(this.onAppMessage,t)},_onMessage:function(t){let e;e=this._safelyParseJSON(t),this._onEvent(e)},_getQueryParams:function(){this.traceIdIncreamenter++;var t=["accId=",this.accId,"&serviceId=",this.serviceId,"&userId=",this.userId,"&ti=",this.traceId+-+this.traceIdIncreamenter,"&token=",this.token,"&cv=",this.clientVersion].join("");return!0===this.nocookie&&(t+="&nocookie=true"),t},_throw:function(t){throw new Error(t)},io:function(){}({1:[function(t,e,n){e.exports=t("./lib/")},{"./lib/":2}],2:[function(t,e,n){var i=t("./url"),o=t("socket.io-parser"),s=t("./manager"),c=t("debug")("socket.io-client");e.exports=n=r;var a=n.managers={};function r(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n=i(t),o=n.source,r=n.id,t=n.path,t=a[r]&&a[r].nsps[t]&&t==a[r].nsps[t].nsp,r=e.forceNew||e["force new connection"]||!1===e.multiplex||t?(c("ignoring socket cache for %s",o),s(o,e)):(a[r]||(c("new io instance for %s",o),a[r]=s(o,e)),a[r]);return r.socket(n.path)}n.protocol=o.protocol,n.connect=r,n.Manager=t("./manager"),n.Socket=t("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":44}],3:[function(t,e,n){t("./url");var c=t("engine.io-client"),o=t("./socket"),r=t("component-emitter"),i=t("socket.io-parser"),a=t("./on"),s=t("component-bind"),h=(t("object-component"),t("debug")("socket.io-client:manager")),u=t("indexof"),p=t("backo2");function l(t,e){if(!(this instanceof l))return new l(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}(e.exports=l).prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)this.nsps[t].emit.apply(this.nsps[t],arguments)},l.prototype.updateSocketIds=function(){},r(l.prototype),l.prototype.reconnection=function(){},l.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},l.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},l.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},l.prototype.reconnectionDelayMax=function(){},l.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},l.prototype.maybeReconnectOnOpen=function(){},l.prototype.open=l.prototype.connect=function(n){if(h("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;h("opening %s",this.uri),this.engine=c(this.uri,this.opts);var t=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var e,r,i=a(t,"open",function(){o.onopen(),n&&n()}),s=a(t,"error",function(t){var e;h("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",t),n?((e=new Error("Connection error")).data=t,n(e)):o.maybeReconnectOnOpen()});return!1!==this._timeout&&(e=this._timeout,h("connect attempt will timeout after %d",e),r=setTimeout(function(){},e),this.subs.push({destroy:function(){clearTimeout(r)}})),this.subs.push(i),this.subs.push(s),this},l.prototype.onopen=function(){},l.prototype.ondata=function(t){this.decoder.add(t)},l.prototype.ondecoded=function(t){this.emit("packet",t)},l.prototype.onerror=function(){},l.prototype.socket=function(t){var e,n=this.nsps[t];return n||(n=new o(this,t),this.nsps[t]=n,e=this,n.on("connect",function(){})),n},l.prototype.destroy=function(t){t=u(this.connected,t);~t&&this.connected.splice(t,1),this.connected.length||this.close()},l.prototype.packet=function(){},l.prototype.processPacketQueue=function(){var t;0<this.packetBuffer.length&&!this.encoding&&(t=this.packetBuffer.shift(),this.packet(t))},l.prototype.cleanup=function(){},l.prototype.close=l.prototype.disconnect=function(){},l.prototype.onclose=function(){},l.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t,e,n=this;this.backoff.attempts>=this._reconnectionAttempts?(h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1):(t=this.backoff.duration(),h("will wait %dms before reconnect attempt",t),this.reconnecting=!0,e=setTimeout(function(){},t),this.subs.push({destroy:function(){clearTimeout(e)}}))},l.prototype.onreconnect=function(){}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:40,"object-component":41,"socket.io-parser":44}],4:[function(){},{}],5:[function(t,e,n){var i=t("socket.io-parser"),o=t("component-emitter"),s=t("to-array"),r=t("./on"),c=t("component-bind"),a=t("debug")("socket.io-client:socket"),h=t("has-binary");e.exports=l;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},p=o.prototype.emit;function l(t,e){this.io=t,this.nsp=e,(this.json=this).ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}o(l.prototype),l.prototype.subEvents=function(){var t;this.subs||(t=this.io,this.subs=[r(t,"open",c(this,"onopen")),r(t,"packet",c(this,"onpacket")),r(t,"close",c(this,"onclose"))])},l.prototype.open=l.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen()),this},l.prototype.send=function(){},l.prototype.emit=function(t){if(u.hasOwnProperty(t))return p.apply(this,arguments),this;var e=s(arguments),n=i.EVENT;h(e)&&(n=i.BINARY_EVENT);n={type:n,data:e};return"function"==typeof e[e.length-1]&&(a("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this},l.prototype.packet=function(){},l.prototype.onopen=function(){},l.prototype.onclose=function(){},l.prototype.onpacket=function(){},l.prototype.onevent=function(){},l.prototype.ack=function(n){var o=this,r=!1;return function(){var t,e;r||(r=!0,t=s(arguments),a("sending ack %j",t),e=h(t)?i.BINARY_ACK:i.ACK,o.packet({type:e,id:n,data:t}))}},l.prototype.onack=function(){},l.prototype.onconnect=function(){},l.prototype.emitBuffered=function(){},l.prototype.ondisconnect=function(){},l.prototype.destroy=function(){},l.prototype.close=l.prototype.disconnect=function(){}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":36,"socket.io-parser":44,"to-array":48}],6:[function(t,e,n){(function(o){var r=t("parseuri"),i=t("debug")("socket.io-client:url");e.exports=function(t,e){var n=t,e=e||o.location;null==t&&(t=e.protocol+"//"+e.host);"string"==typeof t&&("/"==t.charAt(0)&&(t="/"==t.charAt(1)?e.protocol+t:e.hostname+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),i("parse %s",t),n=r(t));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));return n.path=n.path||"/",n.id=n.protocol+"://"+n.host+":"+n.port,n.href=n.protocol+"://"+n.host+(e&&e.port==n.port?"":":"+n.port),n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:42}],7:[function(t,e,n){function(){}(e.exports=o).prototype.duration=function(){},o.prototype.reset=function(){this.attempts=0},o.prototype.setMin=function(t){this.ms=t},o.prototype.setMax=function(t){this.max=t},o.prototype.setJitter=function(t){this.jitter=t}},{}],8:[function(){},{}],9:[function(t,e,n){function o(t){if(t)return function(t){for(var e in o.prototype)t[e]=o.prototype[e];return t}(t)}(e.exports=o).prototype.on=o.prototype.addEventListener=function(){},o.prototype.once=function(){},o.prototype.off=o.prototype.removeListener=o.prototype.removeAllListeners=o.prototype.removeEventListener=function(){},o.prototype.emit=function(){},o.prototype.listeners=function(){},o.prototype.hasListeners=function(t){return!!this.listeners(t).length}},{}],10:[function(t,e,n){function r(o){return r.enabled(o)?function(t){t=(n=t)instanceof Error?n.stack||n.message:n;var e=new Date,n=e-(r[o]||e);r[o]=e,t=o+" "+t+" +"+r.humanize(n),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}(e.exports=r).names=[],r.skips=[],r.enable=function(){},r.disable=function(){r.enable("")},r.humanize=function(){},r.enabled=function(){};try{window.localStorage&&r.enable(localStorage.debug)}catch(t){}},{}],11:[function(t,e,n){e.exports=t("./lib/")},{"./lib/":12}],12:[function(){},{"./socket":13,"engine.io-parser":25}],13:[function(e,h,t){(function(n){var o=e("./transports"),t=e("component-emitter"),p=e("debug")("engine.io-client:socket"),r=e("indexof"),i=e("engine.io-parser"),s=e("parseuri"),c=e("parsejson"),a=e("parseqs");function l(t,e){if(!(this instanceof l))return new l(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t&&(t=s(t),e.host=t.host,e.secure="https"==t.protocol||"wss"==t.protocol,e.port=t.port,t.query&&(e.query=t.query)),this.secure=null!=e.secure?e.secure:n.location&&"https:"==location.protocol,e.host&&(t=e.host.split(":"),e.hostname=t.shift(),t.length?e.port=t.pop():e.port||(e.port=this.secure?"443":"80")),this.agent=e.agent||!1,this.hostname=e.hostname||(n.location?location.hostname:"localhost"),this.port=e.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=a.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=e.rejectUnauthorized||null,this.open()}(h.exports=l).priorWebsocketSuccess=!1,t(l.prototype),l.protocol=i.protocol,(l.Socket=l).Transport=e("./transport"),l.transports=e("./transports"),l.parser=e("engine.io-parser"),l.prototype.createTransport=function(t){p('creating transport "%s"',t);var e=function(){}(this.query);return e.EIO=i.protocol,e.transport=t,this.id&&(e.sid=this.id),new o[t]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:e,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized})},l.prototype.open=function(){var t;if(this.rememberUpgrade&&l.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))t="websocket";else{if(0==this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},l.prototype.setTransport=function(){},l.prototype.probe=function(n){p('probing transport "%s"',n);var o=this.createTransport(n,{probe:1}),e=!1,r=this;function t(){var t;r.onlyBinaryUpgrades&&(t=!this.supportsBinary&&r.transport.supportsBinary,e=e||t),e||(p('probe transport "%s" opened',n),o.send([{type:"ping",data:"probe"}]),o.once("packet",function(t){e||("pong"==t.type&&"probe"==t.data?(p('probe transport "%s" pong',n),r.upgrading=!0,r.emit("upgrading",o),o&&(l.priorWebsocketSuccess="websocket"==o.name,p('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){}))):(p('probe transport "%s" failed',n),(t=new Error("probe error")).transport=o.name,r.emit("upgradeError",t)))}))}function(){}function(){}function c(){s("transport closed")}function a(){s("socket closed")}function(){}function(){}l.priorWebsocketSuccess=!1,o.once("open",t),o.once("error",s),o.once("close",c),this.once("close",a),this.once("upgrading",h),o.open()},l.prototype.onOpen=function(){},l.prototype.onPacket=function(){},l.prototype.onHandshake=function(){},l.prototype.onHeartbeat=function(){},l.prototype.setPing=function(){},l.prototype.ping=function(){this.sendPacket("ping")},l.prototype.onDrain=function(){for(var t=0;t<this.prevBufferLen;t++)this.callbackBuffer[t]&&this.callbackBuffer[t]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)==this.writeBuffer.length?this.emit("drain"):this.flush()},l.prototype.flush=function(){},l.prototype.write=l.prototype.send=function(){},l.prototype.sendPacket=function(t,e,n){"closing"!=this.readyState&&"closed"!=this.readyState&&(e={type:t,data:e},this.emit("packetCreate",e),this.writeBuffer.push(e),this.callbackBuffer.push(n),this.flush())},l.prototype.close=function(){function(){}function(){}function n(){o.once("upgrade",e),o.once("upgradeError",e)}var o;return"opening"!=this.readyState&&"open"!=this.readyState||(this.readyState="closing",(o=this).writeBuffer.length?this.once("drain",function(){}):(this.upgrading?n:t)()),this},l.prototype.onError=function(){},l.prototype.onClose=function(t,e){var n;"opening"!=this.readyState&&"open"!=this.readyState&&"closing"!=this.readyState||(p('socket close with reason: "%s"',t),n=this,clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e))},l.prototype.filterUpgrades=function(){}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:40,parsejson:32,parseqs:33,parseuri:34}],14:[function(t,e,n){var o=t("engine.io-parser");function(){}t("component-emitter")((e.exports=r).prototype),r.timestamps=0,r.prototype.onError=function(t,e){t=new Error(t);return t.type="TransportError",t.description=e,this.emit("error",t),this},r.prototype.open=function(){},r.prototype.close=function(){},r.prototype.send=function(){},r.prototype.onOpen=function(){},r.prototype.onData=function(){},r.prototype.onPacket=function(t){this.emit("packet",t)},r.prototype.onClose=function(){}},{"component-emitter":9,"engine.io-parser":25}],15:[function(e,t,n){(function(s){var c=e("xmlhttprequest"),a=e("./polling-xhr"),h=e("./polling-jsonp"),t=e("./websocket");n.polling=function(t){var e=!1,n=!1,o=!1!==t.jsonp;{var r,i;s.location&&(r="https:"==location.protocol,i=(i=location.port)||(r?443:80),e=t.hostname!=location.hostname||i!=t.port,n=t.secure!=r)}{if(t.xdomain=e,t.xscheme=n,"open"in new c(t)&&!t.forceJSONP)return new a(t);if(!o)throw new Error("JSONP disabled");return new h(t)}},n.websocket=t}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(s,c,t){(function(n){var o=s("./polling"),t=s("component-inherit");c.exports=e;var r,h=/\n/g,u=/\\n/g;function i(){}function(){}t(e,o),e.prototype.supportsBinary=!1,e.prototype.doClose=function(){},e.prototype.doPoll=function(){},e.prototype.doWrite=function(t,e){var n,o,r,i,s=this;function c(){a(),e()}function(){}this.form||(n=document.createElement("form"),o=document.createElement("textarea"),r=this.iframeId="eio_iframe_"+this.index,n.className="socketio",n.style.position="absolute",n.style.top="-1000px",n.style.left="-1000px",n.target=r,n.method="POST",n.setAttribute("accept-charset","utf-8"),o.name="d",n.appendChild(o),document.body.appendChild(n),this.form=n,this.area=o),this.form.action=this.uri(),a(),t=t.replace(u,"\\\n"),this.area.value=t.replace(h,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){}:this.iframe.onload=c}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(u,p,t){(function(o){var r=u("xmlhttprequest"),i=u("./polling"),t=u("component-emitter"),e=u("component-inherit"),s=u("debug")("engine.io-client:polling-xhr");function n(){}function c(t){var e,n;i.call(this,t),o.location&&(e="https:"==location.protocol,n=(n=location.port)||(e?443:80),this.xd=t.hostname!=o.location.hostname||n!=t.port,this.xs=t.secure!=e)}function a(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=null!=t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.create()}function(){}p.exports=c,p.exports.Request=a,e(c,i),c.prototype.supportsBinary=!0,c.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,new a(t)},c.prototype.doWrite=function(){},c.prototype.doPoll=function(){},t(a.prototype),a.prototype.create=function(){},a.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},a.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},a.prototype.onError=function(){},a.prototype.cleanup=function(){},a.prototype.onLoad=function(){var t,e;try{try{e=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(t){}t="application/octet-stream"===e?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},a.prototype.hasXDR=function(){},a.prototype.abort=function(){this.cleanup()},o.document&&(a.requestsCount=0,a.requests={},o.attachEvent?o.attachEvent("onunload",h):o.addEventListener&&o.addEventListener("beforeunload",h,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(t,e,n){var o=t("../transport"),r=t("parseqs"),i=t("engine.io-parser"),s=t("component-inherit"),c=t("debug")("engine.io-client:polling");e.exports=h;var a=null!=new(t("xmlhttprequest"))({xdomain:!1}).responseType;function(){}s(h,o),h.prototype.name="polling",h.prototype.doOpen=function(){this.poll()},h.prototype.pause=function(t){var e,n=this;function(){}this.readyState="pausing",this.polling||!this.writable?(e=0,this.polling&&(c("we are currently polling - waiting to pause"),e++,this.once("pollComplete",function(){c("pre-pause polling complete"),--e||o()})),this.writable||(c("we are currently writing - waiting to pause"),e++,this.once("drain",function(){}))):o()},h.prototype.poll=function(){},h.prototype.onData=function(t){var o=this;c("polling got data %s",t);i.decodePayload(t,this.socket.binaryType,function(){}),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},h.prototype.doClose=function(){var t=this;function(){}"open"==this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},h.prototype.write=function(t){var e=this;this.writable=!1;function(){}e=this;i.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,n)})},h.prototype.uri=function(){}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,xmlhttprequest:20}],19:[function(t,e,n){var o=t("../transport"),r=t("engine.io-parser"),i=t("parseqs"),s=t("component-inherit"),c=t("debug")("engine.io-client:websocket"),a=t("ws");function(){}s(e.exports=h,o),h.prototype.name="websocket",h.prototype.supportsBinary=!0,h.prototype.doOpen=function(){var t,e;this.check()&&(t=this.uri(),(e={agent:this.agent}).pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,this.ws=new a(t,void 0,e),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners())},h.prototype.addEventListeners=function(){},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(h.prototype.onData=function(){}),h.prototype.write=function(t){var e=this;this.writable=!1;for(var n=0,o=t.length;n<o;n++)r.encodePacket(t[n],this.supportsBinary,function(){});setTimeout(function(){e.writable=!0,e.emit("drain")},0)},h.prototype.onClose=function(){o.prototype.onClose.call(this)},h.prototype.doClose=function(){},h.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"==e&&443!=this.port||"ws"==e&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=+new Date),this.supportsBinary||(t.b64=1),(t=i.encode(t)).length&&(t="?"+t),e+"://"+this.hostname+n+this.path+t},h.prototype.check=function(){}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,ws:35}],20:[function(){},{"has-cors":38}],21:[function(t,e,n){e.exports=function(){}},{}],22:[function(t,e,r){function(){}(r=e.exports=t("./debug")).log=function(){},r.formatArgs=function(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+r.humanize(this.diff),!e)return t;e="color: "+this.color;t=[t[0],e,"color: inherit"].concat(Array.prototype.slice.call(t,1));var n=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(n++,"%c"===t&&(o=n))}),t.splice(o,0,e),t},r.save=function(){},r.load=n,r.useColors=function(){},r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],r.formatters.j=function(t){return JSON.stringify(t)},r.enable(n())},{"./debug":23}],23:[function(t,e,s){(s=e.exports=function(t){function e(){}function n(){var o=n,t=+new Date,e=t-(c||t);o.diff=e,o.prev=c,o.curr=t,c=t,null==o.useColors&&(o.useColors=s.useColors()),null==o.color&&o.useColors&&(o.color=s.colors[a++%s.colors.length]);var r=Array.prototype.slice.call(arguments);r[0]=s.coerce(r[0]),"string"!=typeof r[0]&&(r=["%o"].concat(r));var i=0;r[0]=r[0].replace(/%([a-z%])/g,function(){}),"function"==typeof s.formatArgs&&(r=s.formatArgs.apply(o,r)),(n.log||s.log||console.log.bind(console)).apply(o,r)}e.enabled=!1,n.enabled=!0;var o=s.enabled(t)?n:e;return o.namespace=t,o}).coerce=function(t){return t instanceof Error?t.stack||t.message:t},s.disable=function(){s.enable("")},s.enable=function(){},s.enabled=function(){},s.humanize=t("ms"),s.names=[],s.skips=[],s.formatters={};var c,a=0},{ms:24}],24:[function(t,e,n){var o=36e5,r=864e5;function i(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}e.exports=function(t,e){return e=e||{},"string"==typeof t?function(t){t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(t);if(!t)return;var e=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"y":return 315576e5*e;case"days":case"day":case"d":return e*r;case"hours":case"hour":case"h":return e*o;case"minutes":case"minute":case"m":return 6e4*e;case"seconds":case"second":case"s":return 1e3*e;case"ms":return e}}(t):e.long?i(e=t,r,"day")||i(e,o,"hour")||i(e,6e4,"minute")||i(e,1e3,"second")||e+" ms":r<=(t=t)?Math.round(t/r)+"d":o<=t?Math.round(t/o)+"h":6e4<=t?Math.round(t/6e4)+"m":1e3<=t?Math.round(t/1e3)+"s":t+"ms"}},{}],25:[function(y,t,g){(function(h){var t=y("./keys"),e=y("has-binary"),f=y("arraybuffer.slice"),o=y("base64-arraybuffer"),s=y("after"),i=y("utf8"),n=navigator.userAgent.match(/Android/i),r=/PhantomJS/i.test(navigator.userAgent),c=n||r;g.protocol=3;var a=g.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},u=t(a),d={type:"error",data:"parser error"},p=y("blob");function(){}g.encodePacket=function(t,e,n,o){"function"==typeof e&&(o=e,e=!1),"function"==typeof n&&(o=n,n=null);var r=void 0===t.data?void 0:t.data.buffer||t.data;if(h.ArrayBuffer&&r instanceof ArrayBuffer)return function(){}(t,e,o);if(p&&r instanceof h.Blob)return function(t,e,n){if(!e)return g.encodeBase64Packet(t,n);if(c)return function(){}(t,e,n);e=new Uint8Array(1);e[0]=a[t.type];t=new p([e.buffer,t.data]);return n(t)}(t,e,o);if(r&&r.base64)return function(t,e){t="b"+g.packets[t.type]+t.data.data;return e(t)}(t,o);r=a[t.type];return void 0!==t.data&&(r+=n?i.encode(String(t.data)):String(t.data)),o(""+r)},g.encodeBase64Packet=function(e,n){var o,r="b"+g.packets[e.type];if(p&&e.data instanceof p){var i=new FileReader;return i.onload=function(){},i.readAsDataURL(e.data)}try{o=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var s=new Uint8Array(e.data),c=new Array(s.length),a=0;a<s.length;a++)c[a]=s[a];o=String.fromCharCode.apply(null,c)}return r+=h.btoa(o),n(r)},g.decodePacket=function(t,e,n){if("string"==typeof t||void 0===t){if("b"==t.charAt(0))return g.decodeBase64Packet(t.substr(1),e);if(n)try{t=i.decode(t)}catch(t){return d}var o=t.charAt(0);return Number(o)==o&&u[o]?1<t.length?{type:u[o],data:t.substring(1)}:{type:u[o]}:d}o=new Uint8Array(t)[0],n=f(t,1);return p&&"blob"===e&&(n=new p([n])),{type:u[o],data:n}},g.decodeBase64Packet=function(t,e){var n=u[t.charAt(0)];if(!h.ArrayBuffer)return{type:n,data:{base64:!0,data:t.substr(1)}};t=o.decode(t.substr(1));return"blob"===e&&p&&(t=new p([t])),{type:n,data:t}},g.encodePayload=function(t,n,o){"function"==typeof n&&(o=n,n=null);var r=e(t);return n&&r?p&&!c?g.encodePayloadAsBlob(t,o):g.encodePayloadAsArrayBuffer(t,o):t.length?void l(t,function(t,e){g.encodePacket(t,!!r&&n,!0,function(t){e(null,(t=t).length+":"+t)})},function(){}):o("0:")},g.decodePayload=function(t,e,n){if("string"!=typeof t)return g.decodePayloadAsBinary(t,e,n);if("function"==typeof e&&(n=e,e=null),""==t)return n(d,0,1);for(var o,r="",i=0,s=t.length;i<s;i++){var c=t.charAt(i);if(":"!=c)r+=c;else{if(""==r||r!=(o=Number(r)))return n(d,0,1);if(r!=(c=t.substr(i+1,o)).length)return n(d,0,1);if(c.length){if(c=g.decodePacket(c,e,!0),d.type==c.type&&d.data==c.data)return n(d,0,1);if(!1===n(c,i+o,s))return}i+=o,r=""}}return""!=r?n(d,0,1):void 0},g.encodePayloadAsArrayBuffer=function(t,o){if(!t.length)return o(new ArrayBuffer(0));l(t,function(){},function(t,e){var n=e.reduce(function(t,e){e="string"==typeof e?e.length:e.byteLength;return t+e.toString().length+e+2},0),s=new Uint8Array(n),c=0;return e.forEach(function(t){var e="string"==typeof t,n=t;if(e){for(var o=new Uint8Array(t.length),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);n=o.buffer}s[c++]=e?0:1;for(var i=n.byteLength.toString(),r=0;r<i.length;r++)s[c++]=parseInt(i[r]);s[c++]=255;for(o=new Uint8Array(n),r=0;r<o.length;r++)s[c++]=o[r]}),o(s.buffer)})},g.encodePayloadAsBlob=function(t,n){l(t,function(t,s){g.encodePacket(t,!0,!0,function(t){var e=new Uint8Array(1);if(e[0]=1,"string"==typeof t){for(var n=new Uint8Array(t.length),o=0;o<t.length;o++)n[o]=t.charCodeAt(o);t=n.buffer,e[0]=0}for(var r=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),i=new Uint8Array(r.length+1),o=0;o<r.length;o++)i[o]=parseInt(r[o]);i[r.length]=255,p&&(e=new p([e.buffer,i.buffer,t]),s(null,e))})},function(){})},g.decodePayloadAsBinary=function(t,n,o){"function"==typeof n&&(o=n,n=null);for(var e=t,r=[],i=!1;0<e.byteLength;){for(var s=new Uint8Array(e),c=0===s[0],a="",h=1;255!=s[h];h++){if(310<a.length){i=!0;break}a+=s[h]}if(i)return o(d,0,1);e=f(e,2+a.length),a=parseInt(a);var u=f(e,0,a);if(c)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(t){for(var p=new Uint8Array(u),u="",h=0;h<p.length;h++)u+=String.fromCharCode(p[h])}r.push(u),e=f(e,a)}var l=r.length;r.forEach(function(){})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":36,utf8:31}],26:[function(t,e,n){e.exports=Object.keys||function(){}},{}],27:[function(t,e,n){function s(){}e.exports=function(){}},{}],28:[function(t,e,n){e.exports=function(){}},{}],29:[function(t,e,n){!function(u){"use strict";n.encode=function(){},n.decode=function(t){var e,n,o,r,i=.75*t.length,s=t.length,c=0;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);for(var i=new ArrayBuffer(i),a=new Uint8Array(i),h=0;h<s;h+=4)e=u.indexOf(t[h]),n=u.indexOf(t[h+1]),o=u.indexOf(t[h+2]),r=u.indexOf(t[h+3]),a[c++]=e<<2|n>>4,a[c++]=(15&n)<<4|o>>2,a[c++]=(3&o)<<6|63&r;return i}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(t,a,e){(function(t){var r=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder,e=function(){}(),n=e&&function(){}(),o=r&&r.prototype.append&&r.prototype.getBlob;function i(t){for(var e=0;e<t.length;e++){var n,o,r=t[e];r.buffer instanceof ArrayBuffer&&(n=r.buffer,r.byteLength!==n.byteLength&&((o=new Uint8Array(r.byteLength)).set(new Uint8Array(n,r.byteOffset,r.byteLength)),n=o.buffer),t[e]=n)}}function(){}function(){}a.exports=e?n?t.Blob:c:o?s:void 0}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(t,g,m){(function(y){!function(t){var e="object"==typeof m&&m,n="object"==typeof g&&g&&g.exports==e&&g,o="object"==typeof y&&y;o.global!==o&&o.window!==o||(t=o);var r,i,s,c=String.fromCharCode;function(){}function(){}function(){}function(){}var l={version:"2.0.0",encode:function(t){for(var e=a(t),n=e.length,o=-1,r="";++o<n;)r+=function(t){if(0==(4294967168&t))return c(t);var e="";return 0==(4294965248&t)?e=c(t>>6&31|192):0==(4294901760&t)?(h(t),e=c(t>>12&15|224),e+=u(t,6)):0==(4292870144&t)&&(e=c(t>>18&7|240),e+=u(t,12),e+=u(t,6)),e+=c(63&t|128)}(e[o]);return r},decode:function(t){r=a(t),i=r.length,s=0;for(var e,n=[];!1!==(e=function(){var t,e;if(i<s)throw Error("Invalid byte index");if(s==i)return!1;if(t=255&r[s],s++,0==(128&t))return t;if(192==(224&t)){if(128<=(e=(31&t)<<6|p()))return e;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(e=(15&t)<<12|p()<<6|p()))return h(e),e;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(e=(15&t)<<18|p()<<12|p()<<6|p())&&e<=1114111)return e;throw Error("Invalid UTF-8 detected")}());)n.push(e);return function(){}(n)}};if(0,e&&!e.nodeType)if(n)n.exports=l;else{var f,d={}.hasOwnProperty;for(f in l)d.call(l,f)&&(e[f]=l[f])}else t.utf8=l}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(){},{}],33:[function(t,e,n){n.encode=function(){},n.decode=function(){}},{}],34:[function(){},{}],35:[function(t,e,n){var o=function(){return this}(),r=o.WebSocket||o.MozWebSocket;function i(t,e,n){t=e?new r(t,e):new r(t);return t}e.exports=r?i:null,r&&(i.prototype=r.prototype)},{}],36:[function(t,e,n){(function(){}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:37}],37:[function(){},{}],38:[function(){},{global:39}],39:[function(){},{}],40:[function(){},{}],41:[function(t,e,n){var o=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(){},n.values=function(){},n.merge=function(){},n.length=function(t){return n.keys(t).length},n.isEmpty=function(t){return 0==n.length(t)}},{}],42:[function(){},{}],43:[function(t,e,n){(function(u){var p=t("isarray"),l=t("./is-buffer");n.deconstructPacket=function(t){var s=[],e=t.data;return t.data=function t(e){if(!e)return e;if(l(e)){var n={_placeholder:!0,num:s.length};return s.push(e),n}if(p(e)){for(var o=new Array(e.length),r=0;r<e.length;r++)o[r]=t(e[r]);return o}if("object"!=typeof e||e instanceof Date)return e;var i,o={};for(i in e)o[i]=t(e[i]);return o}(e),t.attachments=s.length,{packet:t,buffers:s}},n.reconstructPacket=function(){},n.removeBlobs=function(){}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":45,isarray:46}],44:[function(t,e,s){var c=t("debug")("socket.io-parser"),a=t("json3"),n=(t("isarray"),t("component-emitter")),r=t("./binary"),o=t("./is-buffer");function i(){}function(){}function u(){this.reconstructor=null}function p(t){this.reconPack=t,this.buffers=[]}function(){}s.protocol=4,s.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],s.CONNECT=0,s.DISCONNECT=1,s.EVENT=2,s.ACK=3,s.ERROR=4,s.BINARY_EVENT=5,s.BINARY_ACK=6,s.Encoder=i,s.Decoder=u,i.prototype.encode=function(t,e){var n,o;c("encoding packet %j",t),s.BINARY_EVENT==t.type||s.BINARY_ACK==t.type?(n=t,o=e,r.removeBlobs(n,function(t){var e=r.deconstructPacket(t),t=h(e.packet);(e=e.buffers).unshift(t),o(e)})):e([h(t)])},n(u.prototype),u.prototype.add=function(t){var e;if("string"==typeof t)e=function(t){var e={},n=0;if(e.type=Number(t.charAt(0)),null==s.types[e.type])return l();if(s.BINARY_EVENT==e.type||s.BINARY_ACK==e.type){for(var o="";"-"!=t.charAt(++n)&&(o+=t.charAt(n),n!=t.length););if(o!=Number(o)||"-"!=t.charAt(n))throw new Error("Illegal attachments");e.attachments=Number(o)}if("/"==t.charAt(n+1))for(e.nsp="";++n;){if(","==(i=t.charAt(n)))break;if(e.nsp+=i,n==t.length)break}else e.nsp="/";var r=t.charAt(n+1);if(""!==r&&Number(r)==r){for(e.id="";++n;){var i;if(null==(i=t.charAt(n))||Number(i)!=i){--n;break}if(e.id+=t.charAt(n),n==t.length)break}e.id=Number(e.id)}if(t.charAt(++n))try{e.data=a.parse(t.substr(n))}catch(t){return l()}return c("decoded %s as %j",t,e),e}(t),s.BINARY_EVENT==e.type||s.BINARY_ACK==e.type?(this.reconstructor=new p(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!o(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",e))}},u.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},p.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length!=this.reconPack.attachments)return null;t=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t},p.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":43,"./is-buffer":45,"component-emitter":9,debug:10,isarray:46,json3:47}],45:[function(t,n,e){(function(){}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(t,e,n){e.exports=t(37)},{}],47:[function(t,e,v){!function(t){var w,x,C={}.toString,e="object"==typeof JSON&&JSON,a="object"==typeof v&&v&&!v.nodeType&&v;a&&e?(a.stringify=e.stringify,a.parse=e.parse):a=t.JSON=e||{};var u,_,S,A,c,T,n,I,p,h,B,E,R,l,f,d,y,g,o,r,i,s,N,m=new Date(-0xc782b5b800cec);try{m=-109252==m.getUTCFullYear()&&0===m.getUTCMonth()&&1===m.getUTCDate()&&10==m.getUTCHours()&&37==m.getUTCMinutes()&&6==m.getUTCSeconds()&&708==m.getUTCMilliseconds()}catch(t){}function(){}b("json")||(u="[object Function]",_="[object Number]",S="[object String]",A="[object Array]",c=b("bug-string-char-index"),m||(T=Math.floor,n=[0,31,59,90,120,151,181,212,243,273,304,334],I=function(){}),(w={}.hasOwnProperty)||(w=function(){}),p={boolean:1,number:1,string:1,undefined:1},N=function(t,e){var n,h,o,r=0;for(o in(n=function(){this.valueOf=0}).prototype.valueOf=0,h=new n)w.call(h,o)&&r++;return n=h=null,(N=r?2==r?function(){}:function(){}:(h=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],function(t,e){var n,o,r,i,s,c=C.call(t)==u,a=c||"function"==typeof t.constructor||("object"==(s=typeof(r=t)[i="hasOwnProperty"])?!r[i]:p[s])?w:t.hasOwnProperty;for(n in t)c&&"prototype"==n||!a.call(t,n)||e(n);for(o=h.length;n=h[--o];a.call(t,n)&&e(n));}))(t,e)},b("json-stringify")||(h={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},B=function(){},E=function(t){var e,n='"',o=0,r=t.length,i=10<r&&c;for(i&&(e=t.split(""));o<r;o++){var s=t.charCodeAt(o);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=h[s];break;default:if(s<32){n+="\\u00"+B(2,s.toString(16));break}n+=i?e[o]:c?t.charAt(o):t[o]}}return n+'"'},R=function(t,e,n,o,r,i,s){var c,a,h,u,p,l,f,d,y,g,m,b,v,k;try{c=e[t]}catch(t){}if("object"==typeof c&&c)if("[object Date]"!=(a=C.call(c))||w.call(c,"toJSON"))"function"==typeof c.toJSON&&(a!=_&&a!=S&&a!=A||w.call(c,"toJSON"))&&(c=c.toJSON(t));else if(-1/0<c&&c<1/0){if(I){for(p=T(c/864e5),h=T(p/365.2425)+1970-1;I(h+1,0)<=p;h++);for(u=T((p-I(h,0))/30.42);I(h,u+1)<=p;u++);p=1+p-I(h,u),l=T((v=(c%864e5+864e5)%864e5)/36e5)%24,f=T(v/6e4)%60,d=T(v/1e3)%60,v=v%1e3}else h=c.getUTCFullYear(),u=c.getUTCMonth(),p=c.getUTCDate(),l=c.getUTCHours(),f=c.getUTCMinutes(),d=c.getUTCSeconds(),v=c.getUTCMilliseconds();c=(h<=0||1e4<=h?(h<0?"-":"+")+B(6,h<0?-h:h):B(4,h))+"-"+B(2,u+1)+"-"+B(2,p)+"T"+B(2,l)+":"+B(2,f)+":"+B(2,d)+"."+B(3,v)+"Z"}else c=null;if(n&&(c=n.call(e,t,c)),null===c)return"null";if("[object Boolean]"==(a=C.call(c)))return""+c;if(a==_)return-1/0<c&&c<1/0?""+c:"null";if(a==S)return E(""+c);if("object"==typeof c){for(b=s.length;b--;)if(s[b]===c)throw TypeError();if(s.push(c),y=[],v=i,i+=r,a==A){for(m=0,b=c.length;m<b;m++)g=R(m,c,n,o,r,i,s),y.push(g===x?"null":g);k=y.length?r?"[\n"+i+y.join(",\n"+i)+"\n"+v+"]":"["+y.join(",")+"]":"[]"}else N(o||c,function(t){var e=R(t,c,n,o,r,i,s);e!==x&&y.push(E(t)+":"+(r?" ":"")+e)}),k=y.length?r?"{\n"+i+y.join(",\n"+i)+"\n"+v+"}":"{"+y.join(",")+"}":"{}";return s.pop(),k}},a.stringify=function(t,e,n){var o,r,i,s;if("function"==typeof e||"object"==typeof e&&e)if((s=C.call(e))==u)r=e;else if(s==A){i={};for(var c,a=0,h=e.length;a<h;c=e[a++],(s=C.call(c))!=S&&s!=_||(i[c]=1));}if(n)if((s=C.call(n))==_){if(0<(n-=n%1))for(o="",10<n&&(n=10);o.length<n;o+=" ");}else s==S&&(o=n.length<=10?n:n.slice(0,10));return R("",((c={})[""]=t,c),r,i,o,"",[])}),b("json-parse")||(l=String.fromCharCode,f={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},g=function(){},o=function(){},r=function(){},i=function(t,e,n){n=s(t,e,n);n===x?delete t[e]:t[e]=n},s=function(){},a.parse=function(){}))}(this)},{}],48:[function(){}